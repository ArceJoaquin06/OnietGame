// Variables
let player;
let pata;
let bricks;
let fire;
let meteor;

function preload() {

}

function setup() {
	new Canvas(1500, 800);

	//gravedad
	world.gravity.y = 12;

	//player
	player = new Sprite(200, 350, 28, 50);
    player.friction = 0;
    player.rotationLock = true;
    let cabeza = new Sprite(200, 333);
    cabeza.diameter = 28;
    cabeza.visible = false;
    pata = new Sprite(220, 352, 10, 20);
    pata.visible = false;
    new GlueJoint(player, pata);
    new GlueJoint(player, cabeza);

	//estructura
	// logica de los ladrillos
	bricks = new Group();
	bricks.w = 30;
	bricks.h = 30;
	bricks.visible = true;
	bricks.collider = 'static';
	bricks.tile = '=';

	fire = new Group();
	fire.w = 5;
	fire.h = 2;
	fire.visible = true;
	fire.tile = 'f'

	meteor = new Group();
	meteor.r = 10;
	meteor.visible = true;
	meteor.tile = 'm'

	tilesGroup = new Tiles(
		[
			'=.............',
			'=.............',
			'=.............',
			'=.............',
			'=.............',
			'=..................................======..........................................................................................................................................................................',
			'=.................................==.................m...............................................................................................................................................................................',
			'=................................==...............................................................................................................................................====..........................',
			'=...............................==...............................................................................................................................................=====...........................',
			'=..............................==.....................................................................m.....=====...............................................................============.....========.................................',
			'=.............................==.........................................m.................................=======...................................................m.........=====.............========.................========...========....====.......................====.............====.......................................',
			'=............................==..................m........................................................=========....................m................m.....................====...............========....========.....========...========....====..................====.........................====.......',
			'=..........................==............................................................................===========.........................................................====................========....========.....========...========....====....====....========..........====...........====...................',
			'==........................=.................................===========......===============............=============.........................m...........m.................====.................========....========.....========...========....====....====...====......................====....................',
			'===......................=..fffffffffffffffff...............===========ffffff===============...........===============............................................m........===fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff........................',
			'================================================================================================================================================================================================================================================================================================================================'
		],
		1,
		1,
		bricks.w + 1,
		bricks.h + 1
	);
}

function draw() {
	background("skyblue")
	movePlayers()
	
	// Actualizar la cámara para seguir al jugador
	camera.x = player.x;  // Cambia la posición x de la cámara para que siga al jugador
	camera.y = player.y;  // Cambia la posición y de la cámara para que siga al jugador (opcional)
}


function movePlayers() {
    // Controlar a player
    if (kb.pressing('a')) {
        player.vel.x = -4;
    } else if (kb.pressing('d')) {
        player.vel.x = 4;
    } else {
        player.vel.x = 0;
    }
    if (kb.presses('w')) {
        player.vel.y = -7.5;
    }
}